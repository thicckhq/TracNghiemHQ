<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hệ thống Trắc nghiệm Hải quan</title>
    <!-- Tải Tailwind CSS từ CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Times New Roman', Times, serif;
        }
        /* CSS tùy chỉnh cho pop-up (modal) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 2rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
            max-width: 90%;
            width: 500px;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
            animation: fadeIn 0.3s ease-out;
        }
        .hidden {
            display: none;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-500 to-purple-600 min-h-screen flex items-center justify-center p-4">

    <!-- Container chính của ứng dụng -->
    <div class="bg-white bg-opacity-90 p-10 rounded-3xl shadow-2xl w-full max-w-4xl text-center">
        <!-- Tiêu đề và Mô tả -->
        <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-2">Hệ thống Ôn thi Hải quan</h1>
        <p class="text-gray-600 mb-10 text-lg">Luyện tập, thi thử và nâng cao kiến thức nghiệp vụ khai báo hải quan.</p>

        <!-- Thanh menu chính -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6">
            <button id="adminBtn" data-modal-target="adminModal" class="bg-red-600 text-white font-semibold py-4 px-8 rounded-2xl shadow-lg hover:bg-red-700 transition-all duration-300 transform hover:scale-105">
                Quản trị Admin
            </button>
            <button id="knowledgeBtn" data-modal-target="knowledgeModal" class="bg-purple-600 text-white font-semibold py-4 px-8 rounded-2xl shadow-lg hover:bg-purple-700 transition-all duration-300 transform hover:scale-105">
                Tổng hợp kiến thức
            </button>
            <button id="practiceBtn" data-modal-target="practiceModal" class="bg-blue-600 text-white font-semibold py-4 px-8 rounded-2xl shadow-lg hover:bg-blue-700 transition-all duration-300 transform hover:scale-105">
                Ôn tập trắc nghiệm
            </button>
            <button id="wrongAnswersBtn" data-modal-target="wrongAnswersModal" class="bg-yellow-500 text-white font-semibold py-4 px-8 rounded-2xl shadow-lg hover:bg-yellow-600 transition-all duration-300 transform hover:scale-105">
                Câu đã trả lời sai
            </button>
            <button id="mockExamBtn" data-modal-target="mockExamModal" class="bg-green-600 text-white font-semibold py-4 px-8 rounded-2xl shadow-lg hover:bg-green-700 transition-all duration-300 transform hover:scale-105">
                Thi thử
            </button>
            <button id="accountBtn" data-modal-target="accountModal" class="bg-gray-700 text-white font-semibold py-4 px-8 rounded-2xl shadow-lg hover:bg-gray-800 transition-all duration-300 transform hover:scale-105">
                Tài khoản của tôi
            </button>
        </div>
        
        <!-- Thông tin tác giả và Liên hệ -->
        <div class="mt-8 text-right text-gray-600 text-sm">
            <p>Tác giả: Nguyễn Doãn Vinh</p>
            <button id="showContactBtn" data-modal-target="contactModal" class="mt-2 text-teal-600 hover:text-teal-800 transition-colors duration-200">
                Hiện thông tin liên hệ
            </button>
        </div>
    </div>

    <!-- Modals cho từng menu -->

    <!-- Modal: Quản trị Admin -->
    <div id="adminModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-4 text-center text-gray-800">Quản trị Admin</h2>
            <p class="text-gray-600 mb-4 text-center">
                Đây là nội dung dành cho quản trị viên.
                Để truy cập, bạn cần đăng nhập với quyền admin.
            </p>
            <div class="space-y-4">
                <input type="text" placeholder="Tên đăng nhập" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
                <input type="password" placeholder="Mật khẩu" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
            </div>
            <div class="mt-6 flex justify-center">
                <button class="bg-red-600 text-white font-semibold py-3 px-8 rounded-lg hover:bg-red-700 transition-all duration-300 mr-2">Đăng nhập</button>
                <button data-modal-close="adminModal" class="bg-gray-300 text-gray-800 font-semibold py-3 px-8 rounded-lg hover:bg-gray-400 transition-all duration-300">Đóng</button>
            </div>
        </div>
    </div>
    
    <!-- Modal: Tổng hợp kiến thức -->
    <div id="knowledgeModal" class="modal-overlay hidden">
        <div class="modal-content text-left">
            <h2 class="text-2xl font-bold mb-4 text-center text-gray-800">Tổng hợp kiến thức</h2>
            <p class="text-gray-600 mb-6 text-center">Các văn bản pháp luật quan trọng về thủ tục hải quan.</p>
            
            <div class="space-y-4">
                <div class="p-4 bg-gray-100 rounded-lg shadow-sm">
                    <p class="font-semibold text-lg text-gray-800">Luật Hải quan</p>
                    <p class="text-sm text-gray-600 mb-2">Luật số 54/2014/QH13</p>
                    <a href="https://thuvienphapluat.vn/van-ban/Xuat-nhap-khau/Luat-Hai-quan-2014-256627.aspx" target="_blank" class="text-blue-600 hover:text-blue-800 transition-colors duration-200 underline">
                        Xem chi tiết tại Thư viện Pháp luật
                    </a>
                </div>
                <div class="p-4 bg-gray-100 rounded-lg shadow-sm">
                    <p class="font-semibold text-lg text-gray-800">Nghị định 08/2015/NĐ-CP</p>
                    <p class="text-sm text-gray-600 mb-2">Quy định chi tiết và biện pháp thi hành Luật Hải quan về thủ tục, kiểm tra, giám sát hải quan</p>
                    <a href="https://thuvienphapluat.vn/van-ban/Xuat-nhap-khau/Nghi-dinh-08-2015-ND-CP-quy-dinh-chi-tiet-va-bien-phap-thi-hanh-Luat-Hai-quan-273611.aspx" target="_blank" class="text-blue-600 hover:text-blue-800 transition-colors duration-200 underline">
                        Xem chi tiết tại Thư viện Pháp luật
                    </a>
                </div>
                <div class="p-4 bg-gray-100 rounded-lg shadow-sm">
                    <p class="font-semibold text-lg text-gray-800">Thông tư 38/2015/TT-BTC</p>
                    <p class="text-sm text-gray-600 mb-2">Quy định về thủ tục hải quan; kiểm tra, giám sát hải quan; thuế xuất khẩu, thuế nhập khẩu và quản lý thuế đối với hàng hóa xuất khẩu, nhập khẩu</p>
                    <a href="https://thuvienphapluat.vn/van-ban/Xuat-nhap-khau/Thong-tu-38-2015-TT-BTC-thu-tuc-hai-quan-kiem-tra-giam-sat-hai-quan-thue-xuat-khau-45451.aspx" target="_blank" class="text-blue-600 hover:text-blue-800 transition-colors duration-200 underline">
                        Xem chi tiết tại Thư viện Pháp luật
                    </a>
                </div>
            </div>
            
            <div class="mt-6 flex justify-center">
                <button data-modal-close="knowledgeModal" class="bg-gray-300 text-gray-800 font-semibold py-3 px-8 rounded-lg hover:bg-gray-400 transition-all duration-300">Đóng</button>
            </div>
        </div>
    </div>

    <!-- Modal: Ôn tập trắc nghiệm -->
    <div id="practiceModal" class="modal-overlay hidden">
        <div class="modal-content text-left">
            <h2 id="practiceModalTitle" class="text-2xl font-bold mb-6 text-center text-gray-800">Ôn tập trắc nghiệm</h2>
            
            <div id="subjectSelection">
                <p class="text-gray-600 mb-4 font-semibold">Chọn Môn:</p>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                    <button class="subjectBtn bg-blue-500 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-600 transition-all duration-300" data-subject="customs_law">
                        Pháp luật hải quan
                    </button>
                    <button class="subjectBtn bg-blue-500 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-600 transition-all duration-300" data-subject="foreign_trade">
                        Kỹ thuật nghiệp vụ ngoại thương
                    </button>
                    <button class="subjectBtn bg-blue-500 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-600 transition-all duration-300" data-subject="customs_tech">
                        Kỹ thuật nghiệp vụ hải quan
                    </button>
                </div>
            </div>

            <div id="topicSelection" class="hidden mt-6">
                <p class="text-gray-600 mb-4 font-semibold">Chọn Chuyên đề:</p>
                <div id="topicList" class="space-y-3">
                    <!-- Danh sách chuyên đề sẽ được thêm bằng JavaScript -->
                </div>
            </div>

            <div class="mt-8 flex justify-center">
                <button id="backToSubjectsBtn" class="bg-gray-300 text-gray-800 font-semibold py-3 px-8 rounded-lg hover:bg-gray-400 transition-all duration-300 hidden mr-2">
                    Quay lại
                </button>
                <button data-modal-close="practiceModal" class="bg-gray-300 text-gray-800 font-semibold py-3 px-8 rounded-lg hover:bg-gray-400 transition-all duration-300">Đóng</button>
            </div>
        </div>
    </div>

    <!-- Modal: Câu đã trả lời sai -->
    <div id="wrongAnswersModal" class="modal-overlay hidden">
        <div class="modal-content text-left">
            <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">Câu đã trả lời sai</h2>
            
            <div id="wrongAnswersContent">
                <!-- Nội dung sẽ được tạo bằng JavaScript -->
            </div>

            <div class="mt-8 flex justify-center">
                <button data-modal-close="wrongAnswersModal" class="bg-gray-300 text-gray-800 font-semibold py-3 px-8 rounded-lg hover:bg-gray-400 transition-all duration-300">Đóng</button>
            </div>
        </div>
    </div>

    <!-- Modal: Thi thử -->
    <div id="mockExamModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-2 text-center text-gray-800">Thi thử</h2>
            <p class="text-sm text-gray-600 mb-4 text-center">
                Hình thức thi: 80 câu trắc nghiệm<br>
                Thời gian: 50 phút / 1 môn thi<br>
                <span class="text-xs italic text-gray-500">(Mô phỏng theo giao diện và cách thức thi chính thức)</span>
            </p>
            
            <p class="text-gray-600 mb-4 font-semibold text-center">Hãy chọn môn thi:</p>
            <div id="mockExamSubjectList" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <!-- Danh sách môn thi sẽ được thêm bằng JavaScript -->
            </div>
            
            <div class="mt-6 flex justify-center">
                <button data-modal-close="mockExamModal" class="bg-gray-300 text-gray-800 font-semibold py-3 px-8 rounded-lg hover:bg-gray-400 transition-all duration-300">Đóng</button>
            </div>
        </div>
    </div>

    <!-- Modal Xác nhận Bắt đầu Thi thử -->
    <div id="confirmMockExamModal" class="modal-overlay hidden">
        <div class="modal-content text-center">
            <h2 class="text-2xl font-bold mb-2 text-gray-800">Xác nhận Thi thử</h2>
            <p id="confirmMessage" class="text-gray-600 mb-6">Thời gian làm bài là 50 phút. Bạn chắc chắn muốn bắt đầu?</p>
            <div class="flex justify-center space-x-4">
                <button id="startMockExamBtn" class="bg-green-600 text-white font-semibold py-3 px-8 rounded-lg hover:bg-green-700 transition-all duration-300">Bắt đầu</button>
                <button data-modal-close="confirmMockExamModal" class="bg-gray-300 text-gray-800 font-semibold py-3 px-8 rounded-lg hover:bg-gray-400 transition-all duration-300">Hủy</button>
            </div>
        </div>
    </div>
    
    <!-- Modal: Tài khoản của tôi -->
    <div id="accountModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-4 text-center text-gray-800">Tài khoản của tôi</h2>

            <!-- Phần Thông tin cá nhân -->
            <div class="mb-6">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-xl font-bold text-gray-700">Thông tin cá nhân</h3>
                    <div class="flex items-center space-x-2">
                        <a href="#" class="text-sm text-blue-600 hover:text-blue-800 underline" onclick="showCustomMessage('Tính năng chỉnh sửa đang được phát triển.')">Chỉnh sửa</a>
                        <span class="text-gray-400">|</span>
                        <a href="#" class="text-sm text-red-600 hover:text-red-800 underline" onclick="showCustomMessage('Tính năng đăng xuất đang được phát triển.')">Đăng xuất</a>
                    </div>
                </div>
                <ul class="text-left space-y-2">
                    <li class="p-3 bg-gray-100 rounded-lg"><span class="font-semibold">Tên đăng nhập:</span> user_vinh</li>
                    <li class="p-3 bg-gray-100 rounded-lg"><span class="font-semibold">Mật khẩu:</span> ********</li>
                    <li class="p-3 bg-gray-100 rounded-lg"><span class="font-semibold">Tên hiển thị:</span> Nguyễn Doãn Vinh</li>
                    <li class="p-3 bg-gray-100 rounded-lg"><span class="font-semibold">Email:</span> vinh.nguyen@example.com</li>
                    <li class="p-3 bg-gray-100 rounded-lg"><span class="font-semibold">Số điện thoại:</span> 0912345678</li>
                    <li class="p-3 bg-gray-100 rounded-lg"><span class="font-semibold">Công ty:</span> ABC Company</li>
                </ul>
            </div>

            <!-- Phần Thông tin sử dụng -->
            <div>
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-xl font-bold text-gray-700">Thông tin sử dụng</h3>
                    <a href="#" class="text-sm text-green-600 hover:text-green-800 underline" onclick="showCustomMessage('Tính năng gia hạn bản quyền đang được phát triển.')">Đăng ký/Gia hạn</a>
                </div>
                <ul class="text-left space-y-2">
                    <li class="p-3 bg-gray-100 rounded-lg"><span class="font-semibold">Môn thi đăng ký:</span> Pháp luật hải quan, Kỹ thuật nghiệp vụ ngoại thương</li>
                    <li class="p-3 bg-gray-100 rounded-lg"><span class="font-semibold">Thời hạn sử dụng:</span> Đến 31/12/2025</li>
                </ul>
            </div>

            <div class="mt-6 flex justify-center">
                <button data-modal-close="accountModal" class="bg-gray-300 text-gray-800 font-semibold py-3 px-8 rounded-lg hover:bg-gray-400 transition-all duration-300">Đóng</button>
            </div>
        </div>
    </div>

    <!-- Modal: Liên hệ Admin -->
    <div id="contactModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-4 text-center text-gray-800">Liên hệ Admin</h2>
            <p class="text-gray-600 mb-4 text-center">
                Gửi câu hỏi hoặc yêu cầu hỗ trợ đến quản trị viên.
            </p>
            <div class="space-y-4">
                <input type="text" placeholder="Họ và tên" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500">
                <input type="email" placeholder="Email của bạn" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500">
                <textarea placeholder="Nội dung tin nhắn..." rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"></textarea>
            </div>
            <div class="mt-6 flex justify-center">
                <button class="bg-teal-600 text-white font-semibold py-3 px-8 rounded-lg hover:bg-teal-700 transition-all duration-300 mr-2">Gửi tin nhắn</button>
                <button data-modal-close="contactModal" class="bg-gray-300 text-gray-800 font-semibold py-3 px-8 rounded-lg hover:bg-gray-400 transition-all duration-300">Đóng</button>
            </div>
        </div>
    </div>

    <!-- Modal: Ôn tập/Luyện tập -->
    <div id="quizModal" class="modal-overlay hidden">
        <div class="modal-content text-left">
            <div class="flex items-center justify-between mb-4">
                <h2 id="quizModalTitle" class="text-2xl font-bold text-gray-800">Quiz Title</h2>
                <button id="quizModalBackBtn" class="bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg hover:bg-gray-400 transition-all duration-300">
                    Quay lại
                </button>
            </div>
            <p id="quizStatus" class="text-gray-600 mb-4 text-center">Câu 1/5</p>
            
            <div id="quizContent">
                <!-- Nội dung câu hỏi sẽ được thêm bằng JavaScript -->
                <p id="questionText" class="text-lg font-semibold text-gray-700 mb-4"></p>
                <div id="answersContainer" class="space-y-3">
                    <!-- Đáp án sẽ được thêm bằng JavaScript -->
                </div>
            </div>

            <div id="quizFeedback" class="text-center mt-4 hidden">
                <p id="feedbackText" class="text-lg font-bold"></p>
                <p id="correctAnswerText" class="text-sm text-gray-600 mt-1"></p>
            </div>

            <div class="mt-6 flex justify-center space-x-4">
                <button id="prevQuestionBtn" class="bg-gray-500 text-white font-semibold py-3 px-8 rounded-lg hover:bg-gray-600 transition-all duration-300">
                    Câu trước
                </button>
                <button id="checkAnswerBtn" class="bg-green-600 text-white font-semibold py-3 px-8 rounded-lg hover:bg-green-700 transition-all duration-300">
                    Kiểm tra
                </button>
                <button id="nextQuestionBtn" class="bg-blue-600 text-white font-semibold py-3 px-8 rounded-lg hover:bg-blue-700 transition-all duration-300">
                    Câu tiếp
                </button>
            </div>
        </div>
    </div>

    <script>
        // Chờ toàn bộ nội dung HTML được tải xong
        document.addEventListener('DOMContentLoaded', () => {
            // Dữ liệu chuyên đề và câu hỏi cho từng môn (mock data)
            const subjects = {
                customs_law: {
                    name: "Pháp luật hải quan",
                    topics: [
                        { name: "Pháp luật hải quan", wrongCount: 5, questions: [
                            { text: "Nghị định nào quy định chi tiết một số điều của Luật Hải quan về thủ tục hải quan, kiểm tra, giám sát hải quan?", choices: ["Nghị định 08/2015/NĐ-CP", "Nghị định 08/2013/NĐ-CP", "Nghị định 08/2014/NĐ-CP", "Nghị định 08/2016/NĐ-CP"], answer: "Nghị định 08/2015/NĐ-CP", isWrong: true },
                            { text: "Hàng hóa phải chịu thuế chống bán phá giá được quy định tại văn bản nào?", choices: ["Thông tư 126/2018/TT-BTC", "Thông tư 127/2018/TT-BTC", "Thông tư 128/2018/TT-BTC", "Thông tư 129/2018/TT-BTC"], answer: "Thông tư 127/2018/TT-BTC", isWrong: true },
                            { text: "Theo pháp luật Việt Nam, thời điểm nào được coi là thời điểm xuất khẩu, nhập khẩu hàng hóa?", choices: ["Thời điểm hàng hóa được xếp lên phương tiện vận tải", "Thời điểm cơ quan hải quan hoàn thành thủ tục hải quan", "Thời điểm doanh nghiệp nhận được giấy phép xuất nhập khẩu", "Thời điểm nộp tờ khai hải quan"], answer: "Thời điểm cơ quan hải quan hoàn thành thủ tục hải quan", isWrong: false },
                            { text: "Thuế nhập khẩu ưu đãi đặc biệt áp dụng cho hàng hóa có xuất xứ từ đâu?", choices: ["Các nước có thỏa thuận thương mại tự do với Việt Nam", "Các nước thành viên WTO", "Tất cả các nước", "Các nước phát triển"], answer: "Các nước có thỏa thuận thương mại tự do với Việt Nam", isWrong: true },
                            { text: "Hàng hóa tạm nhập tái xuất để tham gia hội chợ, triển lãm được miễn thuế nhập khẩu trong trường hợp nào?", choices: ["Khi có giấy phép của Bộ Công Thương", "Khi được tái xuất trong thời hạn quy định", "Khi có bảo lãnh của ngân hàng", "Khi được xác nhận của Ban tổ chức hội chợ"], answer: "Khi được tái xuất trong thời hạn quy định", isWrong: false }
                        ]},
                        { name: "Chính sách thuế", wrongCount: 3, questions: [] },
                        { name: "Vi phạm hành chính", wrongCount: 7, questions: [] }
                    ]
                },
                foreign_trade: {
                    name: "Kỹ thuật nghiệp vụ ngoại thương",
                    topics: [
                        { name: "Giao nhận vận tải", wrongCount: 2, questions: [] },
                        { name: "Ngoại thương", wrongCount: 4, questions: [] },
                        { name: "Thanh toán quốc tế", wrongCount: 1, questions: [] }
                    ]
                },
                customs_tech: {
                    name: "Kỹ thuật nghiệp vụ hải quan",
                    topics: [
                        { name: "Thủ tục hải quan", wrongCount: 10, questions: [
                            { text: "Một bộ hồ sơ hải quan bao gồm các chứng từ nào?", choices: ["Tờ khai hải quan, Hóa đơn thương mại, Vận đơn", "Hợp đồng ngoại thương, Giấy chứng nhận xuất xứ", "Hóa đơn thương mại, Vận đơn, Hợp đồng", "Tất cả các đáp án trên đều đúng"], answer: "Tờ khai hải quan, Hóa đơn thương mại, Vận đơn", isWrong: true },
                            { text: "Tờ khai hải quan điện tử được nộp cho cơ quan nào?", choices: ["Chi cục Hải quan nơi làm thủ tục", "Cục Hải quan tỉnh, thành phố", "Tổng cục Hải quan", "Bộ Tài chính"], answer: "Chi cục Hải quan nơi làm thủ tục", isWrong: false },
                            { text: "Hồ sơ hải quan phải được nộp trước thời điểm nào?", choices: ["Trước 01 ngày hàng hóa đến cửa khẩu", "Trước 08 giờ làm việc hàng hóa đến cửa khẩu", "Trong vòng 30 ngày kể từ ngày hàng hóa đến cửa khẩu", "Trước 30 ngày hàng hóa đến cửa khẩu"], answer: "Trong vòng 30 ngày kể từ ngày hàng hóa đến cửa khẩu", isWrong: true }
                        ]},
                        { name: "Chính sách mặt hàng", wrongCount: 6, questions: [] },
                        { name: "Trị giá hải quan", wrongCount: 8, questions: [] },
                        { name: "Xuất xứ hàng hóa", wrongCount: 3, questions: [] },
                        { name: "Sở hữu trí tuệ", wrongCount: 1, questions: [] },
                        { name: "Phân loại hàng hóa", wrongCount: 9, questions: [] }
                    ]
                }
            };
            
            // Lấy các phần tử cần thiết
            const practiceModal = document.getElementById('practiceModal');
            const practiceModalTitle = document.getElementById('practiceModalTitle');
            const subjectSelection = document.getElementById('subjectSelection');
            const topicSelection = document.getElementById('topicSelection');
            const topicList = document.getElementById('topicList');
            const subjectButtons = document.querySelectorAll('.subjectBtn');
            const backToSubjectsBtn = document.getElementById('backToSubjectsBtn');
            const wrongAnswersModal = document.getElementById('wrongAnswersModal');
            const wrongAnswersContent = document.getElementById('wrongAnswersContent');
            const mockExamModal = document.getElementById('mockExamModal');
            const mockExamSubjectList = document.getElementById('mockExamSubjectList');
            const confirmMockExamModal = document.getElementById('confirmMockExamModal');
            const startMockExamBtn = document.getElementById('startMockExamBtn');
            const quizModal = document.getElementById('quizModal');
            const quizModalTitle = document.getElementById('quizModalTitle');
            const quizModalBackBtn = document.getElementById('quizModalBackBtn');
            const quizStatus = document.getElementById('quizStatus');
            const questionText = document.getElementById('questionText');
            const answersContainer = document.getElementById('answersContainer');
            const checkAnswerBtn = document.getElementById('checkAnswerBtn');
            const nextQuestionBtn = document.getElementById('nextQuestionBtn');
            const prevQuestionBtn = document.getElementById('prevQuestionBtn');
            const quizFeedback = document.getElementById('quizFeedback');
            const feedbackText = document.getElementById('feedbackText');
            const correctAnswerText = document.getElementById('correctAnswerText');

            let currentQuizQuestions = [];
            let currentQuestionIndex = 0;
            let currentQuizType = '';

            // Hàm hiển thị danh sách chuyên đề cho phần ôn tập
            function renderPracticeTopics(subject) {
                const subjectData = subjects[subject];
                practiceModalTitle.textContent = subjectData.name;
                topicList.innerHTML = '';
                
                subjectData.topics.forEach(topic => {
                    const topicBtn = document.createElement('button');
                    topicBtn.className = 'w-full bg-blue-400 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-500 transition-all duration-300 topic-btn';
                    topicBtn.textContent = topic.name;
                    topicBtn.dataset.subject = subject;
                    topicBtn.dataset.topic = topic.name;
                    topicList.appendChild(topicBtn);
                });

                subjectSelection.classList.add('hidden');
                topicSelection.classList.remove('hidden');
                backToSubjectsBtn.classList.remove('hidden');

                // Thêm sự kiện click cho các nút chuyên đề
                document.querySelectorAll('.topic-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const subjectName = btn.dataset.subject;
                        const topicName = btn.dataset.topic;
                        const subjectData = subjects[subjectName];
                        const topicData = subjectData.topics.find(t => t.name === topicName);
                        if (topicData && topicData.questions.length > 0) {
                            startQuiz(topicData.questions, topicData.name);
                        } else {
                            showCustomMessage("Chuyên đề này chưa có câu hỏi.");
                        }
                    });
                });
            }

            // Hàm quay lại màn hình chọn môn ôn tập
            function backToSubjects() {
                practiceModalTitle.textContent = "Ôn tập trắc nghiệm";
                topicSelection.classList.add('hidden');
                backToSubjectsBtn.classList.add('hidden');
                subjectSelection.classList.remove('hidden');
            }

            // Hàm hiển thị Form câu đã trả lời sai
            function renderWrongAnswersForm() {
                wrongAnswersContent.innerHTML = '';
                for (const subjectId in subjects) {
                    const subjectData = subjects[subjectId];
                    const subjectHeader = document.createElement('h3');
                    subjectHeader.className = 'text-xl font-bold text-gray-700 mt-4 mb-2';
                    subjectHeader.textContent = subjectData.name;
                    wrongAnswersContent.appendChild(subjectHeader);

                    const topicListContainer = document.createElement('div');
                    topicListContainer.className = 'space-y-2';

                    subjectData.topics.forEach(topic => {
                        const topicItem = document.createElement('div');
                        topicItem.className = 'flex justify-between items-center p-3 bg-gray-100 rounded-lg shadow-sm hover:bg-gray-200 transition-colors duration-200 wrong-topic-item cursor-pointer';
                        topicItem.dataset.topic = topic.name;
                        topicItem.dataset.subject = subjectId;

                        const topicName = document.createElement('span');
                        topicName.className = 'font-semibold text-gray-800';
                        topicName.textContent = topic.name;

                        const wrongCount = document.createElement('span');
                        wrongCount.className = 'text-red-500 font-bold';
                        wrongCount.textContent = `(${topic.wrongCount} câu)`;

                        topicItem.appendChild(topicName);
                        topicItem.appendChild(wrongCount);
                        topicListContainer.appendChild(topicItem);
                    });
                    wrongAnswersContent.appendChild(topicListContainer);
                }

                // Thêm sự kiện click cho các item chuyên đề sai
                document.querySelectorAll('.wrong-topic-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const subjectName = item.dataset.subject;
                        const topicName = item.dataset.topic;
                        const subjectData = subjects[subjectName];
                        const topicData = subjectData.topics.find(t => t.name === topicName);
                        
                        if (topicData) {
                            const wrongQuestions = topicData.questions.filter(q => q.isWrong);
                            if (wrongQuestions.length > 0) {
                                startQuiz(wrongQuestions, `Câu trả lời sai - ${topicName}`);
                            } else {
                                showCustomMessage("Chuyên đề này chưa có câu hỏi sai.");
                            }
                        } else {
                             showCustomMessage("Không tìm thấy chuyên đề.");
                        }
                    });
                });
            }
            
            // Hàm hiển thị danh sách môn thi thử
            function renderMockExamSubjects() {
                mockExamSubjectList.innerHTML = '';
                for (const subjectId in subjects) {
                    const subjectData = subjects[subjectId];
                    const subjectBtn = document.createElement('button');
                    subjectBtn.className = 'mockExamSubjectBtn bg-blue-500 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-600 transition-all duration-300';
                    subjectBtn.textContent = subjectData.name;
                    subjectBtn.dataset.subject = subjectId;
                    mockExamSubjectList.appendChild(subjectBtn);
                }
                
                // Thêm sự kiện click cho các nút môn thi thử
                document.querySelectorAll('.mockExamSubjectBtn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const subject = btn.dataset.subject;
                        confirmMockExamModal.dataset.subject = subject; // Lưu môn thi đã chọn
                        closeModal('mockExamModal');
                        confirmMockExamModal.classList.remove('hidden');
                    });
                });
            }

            // Bắt đầu thi thử sau khi xác nhận
            startMockExamBtn.addEventListener('click', () => {
                const selectedSubject = confirmMockExamModal.dataset.subject;
                const subjectName = subjects[selectedSubject].name;
                showCustomMessage(`Tính năng thi thử môn ${subjectName} đang được phát triển.`);
                closeModal('confirmMockExamModal');
            });

            // Hàm bắt đầu bài quiz
            function startQuiz(questions, title) {
                currentQuizQuestions = questions;
                currentQuestionIndex = 0;
                
                practiceModal.classList.add('hidden');
                wrongAnswersModal.classList.add('hidden');
                mockExamModal.classList.add('hidden');
                confirmMockExamModal.classList.add('hidden');
                quizModal.classList.remove('hidden');
                
                quizModalTitle.textContent = title;
                displayQuestion();
            }

            // Hàm hiển thị câu hỏi hiện tại
            function displayQuestion() {
                const question = currentQuizQuestions[currentQuestionIndex];
                if (!question) return;

                quizStatus.textContent = `Câu ${currentQuestionIndex + 1}/${currentQuizQuestions.length}`;
                questionText.textContent = question.text;
                answersContainer.innerHTML = '';
                quizFeedback.classList.add('hidden');
                checkAnswerBtn.classList.remove('hidden');
                nextQuestionBtn.classList.add('hidden');
                prevQuestionBtn.disabled = currentQuestionIndex === 0;

                question.choices.forEach(choice => {
                    const answerBtn = document.createElement('button');
                    answerBtn.className = 'w-full text-left p-3 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors duration-200';
                    answerBtn.textContent = choice;
                    answerBtn.addEventListener('click', () => selectAnswer(answerBtn));
                    answersContainer.appendChild(answerBtn);
                });
            }

            // Hàm xử lý khi người dùng chọn đáp án
            function selectAnswer(selectedBtn) {
                document.querySelectorAll('#answersContainer button').forEach(btn => {
                    btn.classList.remove('bg-blue-200', 'bg-red-200', 'bg-green-200', 'border-blue-500', 'border-red-500', 'border-green-500');
                });
                selectedBtn.classList.add('bg-blue-200', 'border-blue-500');
            }

            // Hàm kiểm tra đáp án
            function checkAnswer() {
                const question = currentQuizQuestions[currentQuestionIndex];
                const selectedBtn = document.querySelector('#answersContainer button.bg-blue-200');
                if (!selectedBtn) {
                    // Không dùng alert() mà dùng custom modal
                    showCustomMessage('Vui lòng chọn một đáp án.');
                    return;
                }

                const isCorrect = selectedBtn.textContent === question.answer;

                if (isCorrect) {
                    selectedBtn.classList.add('bg-green-200', 'border-green-500');
                    feedbackText.textContent = 'Chính xác! 🎉';
                    feedbackText.classList.add('text-green-600');
                } else {
                    selectedBtn.classList.add('bg-red-200', 'border-red-500');
                    feedbackText.textContent = 'Chưa chính xác. 🤔';
                    feedbackText.classList.add('text-red-600');
                    // Highlight đáp án đúng
                    document.querySelectorAll('#answersContainer button').forEach(btn => {
                        if (btn.textContent === question.answer) {
                            btn.classList.add('bg-green-200', 'border-green-500');
                        }
                    });
                }
                
                quizFeedback.classList.remove('hidden');
                checkAnswerBtn.classList.add('hidden');
                nextQuestionBtn.classList.remove('hidden');
                
                // Vô hiệu hóa tất cả các nút đáp án sau khi kiểm tra
                document.querySelectorAll('#answersContainer button').forEach(btn => btn.disabled = true);
            }

            // Hàm chuyển câu hỏi
            function nextQuestion() {
                if (currentQuestionIndex < currentQuizQuestions.length - 1) {
                    currentQuestionIndex++;
                    displayQuestion();
                } else {
                    // Không dùng alert() mà dùng custom modal
                    showCustomMessage('Bạn đã hoàn thành tất cả câu hỏi của chuyên đề này!');
                    closeModal('quizModal');
                }
            }

            function prevQuestion() {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    displayQuestion();
                }
            }
            
            // Hàm đóng modal
            function closeModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('hidden');
                }
            }
            
            // Hàm hiển thị thông báo tùy chỉnh thay cho alert()
            function showCustomMessage(message) {
                const existingMsg = document.getElementById('customMessageModal');
                if (existingMsg) existingMsg.remove();
                
                const modalHTML = `
                    <div id="customMessageModal" class="modal-overlay">
                        <div class="modal-content">
                            <p class="text-center text-lg font-semibold text-gray-800">${message}</p>
                            <div class="mt-4 flex justify-center">
                                <button data-modal-close="customMessageModal" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition-all duration-300">OK</button>
                            </div>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', modalHTML);
                
                const closeBtn = document.querySelector('#customMessageModal button');
                closeBtn.addEventListener('click', () => {
                    closeModal('customMessageModal');
                });
            }

            // Thêm sự kiện click cho các nút mở modal bằng thuộc tính data-modal-target
            const openModalBtns = document.querySelectorAll('[data-modal-target]');
            openModalBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const modalId = btn.dataset.modalTarget;
                    const modal = document.getElementById(modalId);
                    if (modal) {
                        modal.classList.remove('hidden');
                    }
                    
                    if (modalId === 'practiceModal') {
                        backToSubjects();
                    }
                    if (modalId === 'wrongAnswersModal') {
                        renderWrongAnswersForm();
                    }
                    if (modalId === 'mockExamModal') {
                        renderMockExamSubjects();
                    }
                });
            });

            // Lấy tất cả các nút đóng modal bằng thuộc tính data-modal-close
            const closeModalBtns = document.querySelectorAll('[data-modal-close]');
            closeModalBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    closeModal(btn.dataset.modalClose);
                });
            });

            // Lặp qua các overlay và thêm sự kiện click để đóng modal khi click ra ngoài
            const modalOverlays = document.querySelectorAll('.modal-overlay');
            modalOverlays.forEach(overlay => {
                overlay.addEventListener('click', (event) => {
                    if (event.target === overlay) {
                        closeModal(overlay.id);
                    }
                });
            });

            // Thêm sự kiện click cho các nút môn học (phần ôn tập)
            subjectButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const subject = btn.dataset.subject;
                    renderPracticeTopics(subject);
                });
            });

            // Thêm sự kiện cho các nút điều hướng trong quiz
            checkAnswerBtn.addEventListener('click', checkAnswer);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            prevQuestionBtn.addEventListener('click', prevQuestion);
            quizModalBackBtn.addEventListener('click', () => closeModal('quizModal'));
        });
    </script>
</body>
</html>
